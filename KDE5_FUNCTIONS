default_build() {
 kde5_build
}

function default_install() {
 cmake_install
}


# this is temporarily inactive, as it would overwrite the kde4 dbus stuff
function dbus_install() {
  # make sure that KF5 spells install their D-Bus
  # service files into the system D-Bus service dir

  local dir1 dir2  &&

  dir1=$(pkg-config --variable=session_bus_services_dir dbus-1 \
         | cut -d/ -f-4)                     &&
  dir2=$(echo $dir1 | cut -d/ -f3-)          &&

  if [[ "$KF5DIR" != "$INSTALL_ROOT/usr" ]]  &&
     [[ ! -s "$KF5DIR/$dir2" ]]; then
    mkdir -p "$KF5DIR/share"     &&
    ln -sf "$INSTALL_ROOT/$dir1"  \
           "$KF5DIR/share"
  fi  &&

 cmake_install
}




# we need a default_final, default_post_remove
# so that the mime and desktop databases get updated
update_databases() {
local DD
  DD=$KF5DIR
  if is_depends_enabled $SPELL;then
    update-mime-database $DD/share/mime/
  fi
  if [[ -e $DD/share/desktop-directories ]]; then
    update-desktop-database $DD/share/desktop-directories
  fi
}

default_final() {
  update_databases
}


default_post_remove() {
  update_databases
}
